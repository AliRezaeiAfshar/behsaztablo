
<!-- ...existing code... -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Company Logo Slider</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
</head>
<body>
    <!-- ...existing code... -->
<section aria-labelledby="trusted-by-heading" class="py-20 bg-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-8">
      <h2 id="trusted-by-heading" class="text-display font-sans font-bold text-primary mb-4">مشتریان ما</h2>
      <p class="text-body-lg text-secondary-600 max-w-3xl mx-auto iran-sharp">
        افتخار همکاری با شرکت‌های پیشرو. روی لوگوها فوکوس کنید تا حرکت متوقف شود، یا کنترل‌ها را برای پیمایش استفاده کنید.
      </p>
    </div>

    <div class="relative">
      <!-- Frame -->
      <div id="logo-slider" class="logo-slider rounded-xl shadow-sm bg-white/40 overflow-hidden">
        <!-- Track (original items only; JS will duplicate for seamless loop) -->
        <div class="slider-track flex items-center gap-8 px-6 py-6" role="list" aria-live="off" aria-label="لوگوهای مشتریان">
          <div role="listitem" class="logo-item flex items-center justify-center w-40 h-16">
            <img loading="lazy" src="../assets/images/saipa.webp" alt="لوگوی سایپا" class="max-h-12 object-contain grayscale transition-transform duration-300" />
          </div>
          <div role="listitem" class="logo-item flex items-center justify-center w-40 h-16">
            <img loading="lazy" src="../assets/images/edare-bargh.webp" alt="لوگوی اداره برق" class="max-h-12 object-contain grayscale transition-transform duration-300" />
          </div>
          <div role="listitem" class="logo-item flex items-center justify-center w-40 h-16">
            <img loading="lazy" src="../assets/images/tam (2).webp" alt="لوگوی TAM" class="max-h-12 object-contain grayscale transition-transform duration-300" />
          </div>
          <div role="listitem" class="logo-item flex items-center justify-center w-40 h-16">
            <img loading="lazy" src="../assets/images/iran-khodro.webp" alt="لوگوی ایران‌خودرو" class="max-h-12 object-contain grayscale transition-transform duration-300" />
          </div>
          <div role="listitem" class="logo-item flex items-center justify-center w-40 h-16">
            <img loading="lazy" src="../assets/images/behran.webp" alt="لوگوی بهر‌ان" class="max-h-12 object-contain grayscale transition-transform duration-300" />
          </div>
          <!-- add more distinct logos here if needed -->
        </div>
      </div>

      <!-- Controls -->
      <div class="absolute inset-y-0 left-0 flex items-center pl-2">
        <button id="prevLogo" aria-label="نمایش قبلی" class="control-btn bg-white/90 hover:bg-white text-gray-700 rounded-full p-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-primary">
          <svg class="w-5 h-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M12.707 4.293a1 1 0 010 1.414L8.414 10l4.293 4.293a1 1 0 11-1.414 1.414l-5-5a1 1 0 010-1.414l5-5a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>
        </button>
      </div>
      <div class="absolute inset-y-0 right-0 flex items-center pr-2">
        <button id="nextLogo" aria-label="نمایش بعدی" class="control-btn bg-white/90 hover:bg-white text-gray-700 rounded-full p-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-primary">
          <svg class="w-5 h-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M7.293 15.707a1 1 0 010-1.414L11.586 10 7.293 5.707A1 1 0 018.707 4.293l5 5a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0z" clip-rule="evenodd"/></svg>
        </button>
      </div>
    </div>

    <p class="mt-6 text-center text-sm text-secondary-500">اسلایدر پیوسته و روان؛ برای متوقف کردن حرکت نشانگر ماوس یا فوکوس را روی لوگوها قرار دهید.</p>
  </div>
</section>

<style>
/* Minimal local CSS (complements Tailwind) */
.logo-slider { width: 100%; max-width: 100%; direction: ltr; } /* force LTR for predictable scrollLeft */
.slider-track { display: flex; align-items: center; gap: 2rem; white-space: nowrap; }
.slider-track > .logo-item { flex: 0 0 auto; width: 10rem; display:flex; align-items:center; justify-content:center; }
.logo-item img { max-width: 100%; max-height: 3rem; object-fit:contain; filter:grayscale(100%); transition: transform .25s ease, filter .25s ease; }
.logo-item img:hover, .logo-item img:focus { filter: none; transform: translateY(-3px) scale(1.03); }
.control-btn { width: 40px; height: 40px; display:inline-flex; align-items:center; justify-content:center; }
@media (max-width: 640px) {
  .slider-track > .logo-item { width: 7.5rem; }
  .logo-item img { max-height: 2.2rem; }
}
</style>

<script>
/* Robust, zero-dependency continuous logo slider.
   - Waits for images to load, duplicates original set until track is at least 2x frame width
   - Uses requestAnimationFrame and scrollLeft for smoothness
   - Pauses on hover/focus and when user interacts with controls
   - Works inside RTL pages by forcing LTR on frame (scrollLeft behavior predictable)
*/
(function () {
  const container = document.getElementById('logo-slider');
  if (!container) return;
  const track = container.querySelector('.slider-track');
  const prevBtn = document.getElementById('prevLogo');
  const nextBtn = document.getElementById('nextLogo');
  if (!track) return;

  // Ensure predictable direction when page is RTL
  container.style.direction = 'ltr';

  // Wait for images to load so measurements are correct
  const imgs = Array.from(track.querySelectorAll('img'));
  const imgsLoaded = imgs.length ? Promise.all(imgs.map(img => new Promise(res => {
    if (img.complete && img.naturalWidth) return res();
    img.addEventListener('load', res, { once: true });
    img.addEventListener('error', res, { once: true });
  }))) : Promise.resolve();

  imgsLoaded.then(() => {
    // Save original HTML and duplicate until the track is comfortably larger than container
    const originalHTML = track.innerHTML;
    // minimal safety: if there are too few items, ensure at least 2 copies
    if (!originalHTML.trim()) return;
    // Duplicate until track width >= 2 * container width (gives seamless reset)
    let tries = 0;
    while (track.scrollWidth < container.clientWidth * 2 && tries < 8) {
      track.insertAdjacentHTML('beforeend', originalHTML);
      tries++;
    }

    // If still not enough (very wide viewport), append one more time
    if (track.scrollWidth < container.clientWidth * 2) {
      track.insertAdjacentHTML('beforeend', originalHTML);
    }

    // Auto-scroll state
    let rafId = null;
    let last = null;
    let running = true;
    // speed in pixels per millisecond (adjustable)
    const speed = 0.04; // ~40px/sec

    function step(ts) {
      if (!running) { rafId = null; last = null; return; }
      if (!last) last = ts;
      const dt = ts - last;
      last = ts;
      // advance scroll
      container.scrollLeft += speed * dt;

      // seamless reset: when we've scrolled more than half the track (one full original set),
      // subtract half to continue seamlessly
      const resetPoint = track.scrollWidth / 2;
      if (container.scrollLeft >= resetPoint) {
        container.scrollLeft -= resetPoint;
      }
      rafId = requestAnimationFrame(step);
    }

    // start
    if (!rafId) rafId = requestAnimationFrame(step);

    // pause / resume helpers
    function pause() { running = false; }
    function resume() { if (!running) { running = true; last = null; if (!rafId) rafId = requestAnimationFrame(step); } }

    // Pause on interaction
    container.addEventListener('mouseenter', pause);
    container.addEventListener('mouseleave', resume);
    container.addEventListener('focusin', pause);
    container.addEventListener('focusout', resume);
    container.setAttribute('tabindex', '0');

    // Controls
    function scrollChunk(px) {
      pause();
      container.scrollBy({ left: px, behavior: 'smooth' });
      // resume after short delay (let animation finish)
      clearTimeout(container._resumeTimeout);
      container._resumeTimeout = setTimeout(() => resume(), 700);
    }
    nextBtn && nextBtn.addEventListener('click', () => scrollChunk(container.clientWidth * 0.6));
    prevBtn && prevBtn.addEventListener('click', () => scrollChunk(-container.clientWidth * 0.6));

    // keyboard
    container.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowRight') { e.preventDefault(); nextBtn && nextBtn.click(); }
      else if (e.key === 'ArrowLeft') { e.preventDefault(); prevBtn && prevBtn.click(); }
      else if (e.key === ' ' || e.key === 'Spacebar') { e.preventDefault(); running ? pause() : resume(); }
    });

    // Keep layout correct on resize (re-duplicate if needed)
    let resizeTimeout;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(() => {
        // if not enough width after resize, duplicate one more time
        if (track.scrollWidth < container.clientWidth * 2) {
          track.insertAdjacentHTML('beforeend', originalHTML);
        }
      }, 250);
    });
  });
})();
</script>
<!-- ...existing code... -->
</body>
</html>